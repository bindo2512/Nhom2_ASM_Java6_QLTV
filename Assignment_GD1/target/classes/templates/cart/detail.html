<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" th:replace="~{/layout/index :: dynamic(~{::main})}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Book Detail</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap) -->
    <link href="../assest/css/styles.css" rel="stylesheet" />
</head>

<body>
    <main th:object="${item}" ng-controller="book-detail-controller">
        <div class="container py-5">
            <div class="row">
                <div class="col-md-3">
                    <img th:src="@{|/assest/image/products/${item.image}|}" alt="Book Cover" class="img-fluid"
                        style="max-width: 250px; margin-left: 15px;">
                </div>
                <div class="col-md-9">
                    <h1>[[${item.bname.bookname}]]</h1>
                    <hr>
                    <div class="row">
                        <div class="col">
                            <p><h4>Nhà xuất bản</h4> <img th:src="@{|/assest/image/publishers/${item.publishers.publisherimage}|}"
                                style="width: 25px; height:25px; border-radius:50% ; margin-right:5px;"><h6>[[${item.publishers.publishername}]]</h6></p>
                                <p>
                                <h4>Tác giả</h4>
                                <h6> <img th:src="@{|/assest/image/authors/${item.authors.authorimage}|}"
                                        style="width: 25px; height:25px; border-radius:50% ; margin-right:5px;">
                                    [[${item.authors.authorname}]]</h6>
                                </p>
                                <p>
                                <h4>Năm xuất bản</h4> [[${item.bname.bookreleaseyear}]]</p>
                                <p>
                        </div>
                        <div class="col">
                            <p><h4>Nhà phát hành</h4> <h6><img th:src="@{|/assest/image/issuers/${item.issuer.issuerimage}|}"
                                style="width: 25px; height:25px; border-radius:50% ; margin-right:5px;"> [[${item.issuer.issuername}]]</h6></p>
                            <p><h4>Loại bìa</h4>[[${item.hardcover}?'Bìa cứng':'Bìa mềm']]</p>
                            <p><h4>Thể loại</h4>[[${item.categories.categoryname}]]</p>
                        </div>
                    </div>
                    <hr>
                    <h4>Nội dung:</h4>
                    <div ng-style="expandText">[[${item.bname.bookdescription}]]</div> <button style="border:none;"
                        ng-click="toggleText()" ng-bind="buttonText"></button> </p>
                    <hr>
                    <a th:href="@{|/qltv/products/pdf/${item.bookid}|}" class="btn btn-primary">
                        <i class="bi-book me-1"></i>
                        Đọc sách Online
                    </a>
                    <a th:href="@{|/assest/pdf/${item.pdf}|}" class="btn btn-secondary" th:attr="download=${item.pdf}">
                        <i class="bi-download me-1"></i>
                        Tải PDF
                    </a>
                    <th:block th:if="${#request.remoteUser}">
                        <th th:if="${item.available}">
                            <button th:attr="ng-click=@{|cart.add(${item.bookid})|}" class="btn btn-success">
                                <i class="bi-bookmark-plus me-1"></i>
                                Mượn sách (bản cứng)
                            </button>
                        </th>&nbsp
                        <th th:if="!${item.available}">
                            <h3><span class="badge bg-danger" style="margin-top: 10px;  width: 270px;">Sản phẩm đã hết
                                    hàng</span></h3>
                        </th>
                    </th:block>
                </div>
            </div>
            <br>
            <div id="comment-section">
                <h4>Comments</h4>
                <ul id="comment-list">
                </ul>
                <form class="form-block">
                    <div class="row">
                        <div class="col-xs-12 col-sm-6">
                            <div class="form-group fl_icon">
                                <div class="icon"><i class="fa fa-user"></i></div>
                                <input class="form-input" type="text" placeholder="Your name" th:text="${#request.remoteUser}">
                            </div>
                        </div>
                        <div class="col-xs-12">									
                            <div class="form-group">
                                <textarea class="form-input" required="" placeholder="Your text"></textarea>
                            </div>
                        </div>
                        <a class="btn btn-primary pull-right">submit</a>
                    </div>
                </form>
                <div th:value="${item.bookid}" id="thymeleafValue" style="display: none;" ng-model="bookid"></div>
                
                <div class="be-comment-block">
                    <h1 class="comment-title"></h1>
                    <div ng-repeat="c in commentlist">
                        <div class="be-comment">
                            <div class="be-img-comment">	
                                <a>
                                    <img th:src="@{|/assest/image/users/{{c.accounts.accountdetail.image}}|}" alt="" class="be-ava-comment">
                                </a>
                            </div>
                            <div class="be-comment-content">
                                
                                    <span class="be-comment-name">
                                        <a>{{c.accounts.accountdetail.fullname}}</a>
                                        </span>
                                    <span class="be-comment-time">
                                        <i class="fa fa-clock-o"></i>
                                        {{c.commentdate}}
                                    </span>
                    
                                <p class="be-comment-text">
                                    {{c.commentdes}}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <style>
                .comment-section {
                    width: 80%;
                    /* Điều chỉnh độ rộng */
                    margin: 0 auto;
                    padding: 20px;
                    background-color: #f8f8f8;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }

                /* Tiêu đề "Comments" */
                .comment-section h2 {
                    font-size: 24px;
                    margin-bottom: 10px;
                    color: #333;
                }

                /* Danh sách bình luận */
                #comment-list {
                    list-style: none;
                    padding: 0;
                }

                #comment-list li {
                    background-color: #fff;
                    border: 1px solid #ddd;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 5px;
                }

                /* Form nhập bình luận */
                .comment-form {
                    margin-top: 20px;
                }

                #comment-input {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }

                #comment-button {
                    background-color: #007bff;
                    color: #fff;
                    border: none;
                    padding: 10px 20px;
                    cursor: pointer;
                    border-radius: 5px;
                }

                #comment-button:hover {
                    background-color: #0056b3;
                }

                /* Comment form */


                .be-comment-block {
                    margin-bottom: 50px !important;
                    border: 1px solid #edeff2;
                    border-radius: 2px;
                    padding: 50px 0px;
                    border: 1px solid #ffffff;
                }

                .comments-title {
                    font-size: 26px;
                    color: #262626;
                    margin-bottom: 15px;
                    font-family: 'Conv_helveticaneuecyr-bold';
                }

                .be-img-comment {
                    width: 60px;
                    height: 60px;
                    float: left;
                    margin-bottom: 15px;
                }

                .be-ava-comment {
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                }

                .be-comment-content {
                    margin-left: 80px;
                }

                .be-comment-content span {
                    display: inline-block;
                    width: 100%;
                    margin-bottom: 15px;
                }

                .be-comment-name {
                    font-size: 13px;
                    font-family: 'Conv_helveticaneuecyr-bold';
                }

                .be-comment-content a {
                    color: #383b43;
                }

                .be-comment-content span {
                    display: inline-block;
                    width: 49%;
                    margin-bottom: 15px;
                }

                .be-comment-time {
                    text-align: right;
                }

                .be-comment-time {
                    font-size: 11px;
                    color: #b4b7c1;
                }

                .be-comment-text {
                    font-size: 1.2rem;
                    line-height: 18px;
                    color: #7a8192;
                    display: block;
                    background: #f6f6f7;
                    border: 1px solid #edeff2;
                    padding: 15px 20px 20px 20px;
                }

                .form-group.fl_icon .icon {
                    position: absolute;
                    top: 1px;
                    left: 16px;
                    width: 48px;
                    height: 48px;
                    background: #f6f6f7;
                    color: #b5b8c2;
                    text-align: center;
                    line-height: 50px;
                    -webkit-border-top-left-radius: 2px;
                    -webkit-border-bottom-left-radius: 2px;
                    -moz-border-radius-topleft: 2px;
                    -moz-border-radius-bottomleft: 2px;
                    border-top-left-radius: 2px;
                    border-bottom-left-radius: 2px;
                }

                .form-group .form-input {
                    font-size: 13px;
                    line-height: 50px;
                    font-weight: 400;
                    color: #b4b7c1;
                    width: 100%;
                    height: 50px;
                    padding-left: 20px;
                    padding-right: 20px;
                    border: 1px solid #edeff2;
                    border-radius: 3px;
                }

                .form-group.fl_icon .form-input {
                    padding-left: 70px;
                }

                .form-group textarea.form-input {
                    height: 150px;
                }
            </style>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS -->
</body>

</html>